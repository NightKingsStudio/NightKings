<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sign-up</title>
    <link rel="icon" href="https://firebasestorage.googleapis.com/v0/b/nightkingsweb.appspot.com/o/Web.png?alt=media&token=85bac74c-03b3-427a-9131-f50aa2a3f48d" type="image/png">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    
    <div class="header_wraped">
        <header class="header_header">
            <a class="logo">
                <img src="https://firebasestorage.googleapis.com/v0/b/nightkingsweb.appspot.com/o/Logo.svg?alt=media&token=45633b64-ceff-4c1f-b599-f9ef0439af0e" class="logo-image" type="image/svg">
                <span class="logo-text">Night Kings Studio</span>
            </a>
            <nav class="header_navigation" aria-label="Site Navigation">
                <ul class="header_menu">
                    <li class="header_menuItem">
                        <a href="/" class="header_menuLink">Blade Rush</a>
                        <a href="/" class="header_menuLink">Support</a>
                    </li>
                    <div class="header_account">
                        <button type="button" id="accountDropdown" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="account-dropdown_trigger hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none">
                                <g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" clip-path="url(#user_svg__a)">
                                    <path d="M6.751 9.75a5.25 5.25 0 1 0 10.5 0 5.25 5.25 0 0 0-10.5 0M18.914 20.876a9.746 9.746 0 0 0-13.826 0"></path>
                                    <path d="M.751 12a11.25 11.25 0 1 0 22.5 0 11.25 11.25 0 0 0-22.5 0"></path>
                                </g>
                                <defs>
                                    <clipPath id="user_svg__a">
                                        <path fill="#fff" d="M.001 0h24v24h-24z"></path>
                                    </clipPath>
                                </defs>
                            </svg>
                            <div class="account-dropdown_displayName">Account</div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="11" height="7" fill="none" class="account-dropdown_dropDownIcon">
                                <path fill="currentColor" fill-rule="evenodd" d="M.293 1.294a1 1 0 0 1 1.414 0L5 4.587l3.293-3.293a1 1 0 1 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 0 1 0-1.414" clip-rule="evenodd"></path>
                            </svg>
                        </button>
                        <div id="usernameDisplay" class="hidden"></div>
                    </div>
                </ul>
            </nav>
        </header>
    </div>
    
    <style>
        header {
            background-color: #000000;
            padding: 20px;
            display: flex;
            justify-content: space-between; 
            align-items: center;
            position: relative; 
        }
    
        header {
            display: block;
            unicode-bidi: isolate;
        }
    
        .header_header {
            height: 100%;
            width: 100%;
            max-width: 1536px;
            min-width: 320px;
            display: flex;
            justify-content: center;
            padding: 0 calc(2 * 1rem);
        }
    
        * {
            margin: 0;
            padding: 0;
        }
    
        .header_wraped {
            height: calc(5 * 1rem);
            width: 100%;
            position: fixed;
            z-index: 10;
            background-color: #000;
            display: flex;
            justify-content: center;
        }
    
        * {
            margin: 0;
            padding: 0;
        }   
    
    
        .header_navigation {
            height: 100%;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 100px;
            top: 0;
            justify-self: left;
            align-self: self-start;
            z-index: 2;
        }
    
        * {
            margin: 0;
            padding: 0;
        }
        
        .header_menuItem {
            height: 100%;
            grid-area: links;
            justify-self: left;
            align-self: center;
            display: grid;
            grid-auto-flow: column;
            grid-gap: calc(1* 1rem);
            gap: calc(1* 1rem);
        }
    
        .header_menuItem {
            height: 100%;
            display: flex;
            align-items: center;
        }
    
        * {
            margin: 0;
            padding: 0;
        }
    
        ul {
            list-style: none;
            margin-left: 0;
        }
    
        * {
            margin: 0;
            padding: 0;
        }
    
        .logo {
            display: flex;
            align-items: center;
            color: #ffffff;
            font-size: 1.8em;
            padding-right: 20px;
            white-space: nowrap; 
            font-family: Montserrat, sans-serif;
            font-weight: lighter;
            font-style: normal;
        }
    
        .logo-image {
            height: 40px; 
            margin-right: 10px; 
        }
    
        .header_menu_container {
            flex-grow: 1; 
            display: flex;
            justify-content: flex-start; 
            margin-left: 25px;
        }
    
        .header_menu {
            list-style: none;
            display: flex;
            margin: 0;
            padding: 0;
        }
    
        .header_menuItem {
            margin-right: 40px; 
        }
    
        .header_menuLink {
            color: #e0e0e0;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }
    
        .header_menuLink:hover {
            color: #5b00d3;
        }
        
    
        .header_account {
            box-shadow: inset 0 -3px 0 #5b00d3;
        }
    
        .header_account {
            margin-left: auto;
            justify-self: left;
            display: flex;
            align-items: center;
            position: relative;
        }
    
        .account-dropdown_trigger {
            background: none;
            border: none;
            color: #ffffff;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-size: 1em;
            padding: 10px;
            transition: color 0.3s; 
        }
    
        .account-dropdown_displayName {
            margin-left: 10px;
            font-size: 1em;
        }
    
        .account-dropdown_dropDownIcon {
            margin-left: 10px;
        }
    
        .header_account .account-dropdown_trigger {
            background: transparent; 
            border: none;
            color: #ffffff; 
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 10px; 
            transition: color 0.3s; 
        }
    
        .header_account .account-dropdown_trigger svg {
            stroke: #ffffff; 
            transition: stroke 0.3s;
        }
    
        .header_account .account-dropdown_trigger:hover {
            color: #5b00d3; 
        }
    
        .header_account .account-dropdown_trigger:hover svg {
            stroke: #5b00d3; 
        }
    
    </style>

    <main class="main">
        <div class="overlay"></div>
        <video autoplay muted loop id="background-video">
            <source src="https://videos.teamtailor-cdn.com/tt-videos-production/uploads_converted/cover_large/fce5799b1ed7247b35d9f673bf3ea19b17e49a23.mp4" type="video/mp4">
            <source src="https://videos.teamtailor-cdn.com/tt-videos-production/uploads_converted/cover_large/fce5799b1ed7247b35d9f673bf3ea19b17e49a23.webm" type="video/webm">
            Your browser does not support the video tag.
        </video>

        <section class="page-container">
            <!-- Sign Up Form -->
            <div class="sign-up-form-container">
                <h2 class="sign-up-title">Sign Up</h2>
                <form class="sign-up-form" id="sign-up-form">
                    <div class="input-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" placeholder="Enter your username" required>
                        <span id="username-error" class="error-message"></span>
                    </div>
                    <div class="input-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" placeholder="Enter your email" required>
                        <span id="email-error" class="error-message"></span>
                    </div>
                    <div class="input-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="sign-up-button">Sign Up</button>
                </form>
                <div class="sign-in-text">
                    <a href="/NightKings/sign-in" class="sign-in-link">Go back</a>
                </div>
            </div>
        </section>
    </main>

    <div class="footer_wraped">
        <footer class="footer_footer">
            <div class="footer_content">
                <a class="footer_logo">
                    <img src="https://firebasestorage.googleapis.com/v0/b/nightkingsweb.appspot.com/o/Logo.svg?alt=media&token=45633b64-ceff-4c1f-b599-f9ef0439af0e" class="footer-logo-image" type="image/svg">
                    <span class="footer-logo-text">Night Kings Studio</span>
                </a>
                <p>&copy; 2024 Night Kings Studio AB. Night Kings Studio, Night Kings, and Blade Rush are trademarks or registered trademarks of Night Kings Studio AB. All other trademarks and trade names are the property of their respective owners.</p>
            </div>
        </footer>
    </div>
    
    <style>
    .footer_wraped {
        height: auto; 
        width: 100%;
        position: relative;
        z-index: 10;
        background-color: #000000; 
        display: flex;
        justify-content: center;
        padding: 20px;
    }
    
    .footer_footer {
        width: 100%;
        max-width: 1536px;
        min-width: 320px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 calc(2 * 1rem);
        flex-direction: column;
        background-color: #000000;
    }
    
    .footer_content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        flex-wrap: wrap; 
    }
    
    .footer_logo {
        display: flex;
        align-items: center;
        color: #ffffff;
        font-size: 1.8em;
        font-weight: bold;
        margin-bottom: 10px;
    }
    
    .footer-logo-image {
        height: 40px; 
        margin-right: 10px; 
    }
    
    .footer-logo-text {
        color: #ffffff;
        font-family: Montserrat, sans-serif;
        font-weight: lighter;
        font-style: normal;
        white-space: nowrap;
    }
    
    footer p {
        color: #ffffff;
        font-size: 0.8em;
        text-align: right;
        margin: 0;
        padding: 0 20px;
    }
    
    </style>
    

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body, button, input, label {
            font-family: Montserrat, sans-serif;
        }

        /* Main container */
        .main {
            flex: 1 0 auto;
            display: flex;
            justify-content: flex-start; /* Align to left */
            align-items: center;
            position: relative;
            overflow: hidden;
            padding-top: 60px;
            padding-left: 20px; /* Optional padding for space on the left */
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5); /* Semi-transparent overlay */
            z-index: 1;
        }

        #background-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
        }

        .page-container {
            display: flex;
            justify-content: flex-start; /* Align sign-up form to the left */
            align-items: center;
            width: 100%;
            max-width: 1200px;
            padding: 20px;
            z-index: 2;
        }

        /* Sign Up Form Container */
        .sign-up-form-container {
            background-color: #000; /* Black background color */
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 100%;
            position: relative;
            color: white; /* White text for contrast */
            margin-left: 20px; /* Optional margin */
        }

        /* Sign Up Form Title */
        .sign-up-title {
            font-size: 2rem;
            font-weight: 600;
            color: white;
            text-align: center;
            margin-bottom: 20px;
        }

        /* Form styling */
        .sign-up-form {
            display: flex;
            flex-direction: column;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            font-size: 1rem;
            font-weight: 500;
            color: white; /* White label color */
            margin-bottom: 8px;
            display: block;
        }

        input[type="text"], input[type="email"], input[type="password"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus, input[type="email"]:focus, input[type="password"]:focus {
            border-color: #5b00d3;
            outline: none;
        }

        .sign-up-button {
            background-color: #5b00d3;
            color: white;
            font-size: 1.2rem;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .sign-up-button:hover {
            background-color: #45009d;
        }

        /* Sign-in text below the form */
        .sign-in-text {
            text-align: center;
            margin-top: 15px;
            font-size: 0.875rem;
            color: #e5e5e5;
        }

        .sign-in-link {
            color: #5b00d3;
            text-decoration: none;
            font-weight: 600;
        }

        .sign-in-link:hover {
            text-decoration: underline;
        }

        .error-message {
            color: red;
            font-size: 0.875rem;
            display: none;
        }
    </style>

    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, updateProfile } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
        import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCJF2ziaPmIDnQF1sB9fx1uScsVX8YrsCw",
            authDomain: "nightkingsweb.firebaseapp.com",
            projectId: "nightkingsweb",
            storageBucket: "nightkingsweb.appspot.com",
            messagingSenderId: "451754358701",
            appId: "1:451754358701:web:7158d032068b69b5366d1d"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        const usernameInput = document.getElementById('username');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const signUpForm = document.getElementById('sign-up-form');
        const usernameError = document.getElementById('username-error');
        const emailError = document.getElementById('email-error');

        // Function to generate a random 4-digit number
        function generateRandomNumber() {
            return Math.floor(1000 + Math.random() * 9000);
        }

        // Function to validate username
        function isValidUsername(username) {
            const minLength = 4;
            const swearWords = ['niger', 'gay', 'adofhittler', 'neger']; 
            if (username.length < minLength) {
                return false;
            }
            for (const swear of swearWords) {
                if (username.toLowerCase().includes(swear)) {
                    return false;
                }
            }
            return true;
        }

        signUpForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = usernameInput.value.trim();
            const email = emailInput.value.trim();
            const password = passwordInput.value;

            if (!isValidUsername(username)) {
                usernameError.textContent = "Invalid username. It must be at least 4 characters long and cannot contain inappropriate words.";
                usernameError.style.display = 'block';
                return;
            }

            usernameError.style.display = 'none';

            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    const uid = user.uid;
                    const uniqueUsername = `${username}#${generateRandomNumber()}`;
                    
                    // Update user profile with username
                    updateProfile(user, { displayName: uniqueUsername })
                        .then(() => {
                            // Save additional user info to the database
                            set(ref(database, 'users/' + uid), {
                                username: uniqueUsername,
                                email: email,
                                accountLocked: false
                            });
                            console.log('User signed up and data saved:', user);
                            window.location.href = '/NightKings/404'; // Redirect to login page
                        })
                        .catch((error) => {
                            console.error('Error updating profile:', error);
                        });
                })
                .catch((error) => {
                    console.error('Error signing up:', error);
                    if (error.code === 'auth/email-already-in-use') {
                        emailError.textContent = 'Email already in use';
                        emailError.style.display = 'block';
                    } else {
                        emailError.textContent = 'Error signing up. Please try again.';
                        emailError.style.display = 'block';
                    }
                });
        });

    </script>
</body>
</html>
